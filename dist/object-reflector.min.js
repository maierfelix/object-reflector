(function(b,a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define(a):b.ObjectReflector=a()})(this,function(){var b=function(a){void 0===a&&(a={});this.object=null;this.children=[];this.properties=[];this.processOptions(a)};b.prototype.processOptions=function(a){if(!a.hasOwnProperty("object"))throw Error("Expected target object but got nothing");if(null===a.object)throw Error("Invalid type for object definition! Expect Object but got null");
if("object"!==typeof a.object)throw Error("Invalid type for object definition! Expect Object but got "+typeof object);this.object=a.object;this.enableChildReflection=a.enableChildReflection;a.hasOwnProperty("properties")&&this.linkProperties(a.properties)};b.prototype.linkProperties=function(a){if(!Array.isArray(a))throw Error("Invalid type for property definitions! Expected Array but got "+typeof a);this.properties=a;this.properties.length&&this.createObjectPropertyLinks(this.object);return this};
b.prototype.clear=function(){this.enableChildReflection&&this.clearChildReflections();this.clearParentReflection();this.children=[]};b.prototype.clearParentReflection=function(){for(var a=this.object,d=this.properties,c=0;c<d.length;++c){var b=d[c];this.clearReflectedObjectProperty(a,b,!0);this.clearReflectedObjectProperty(a,"__$"+b,!1)}};b.prototype.clearChildReflections=function(){for(var a=this.children,d=0;d<a.length;++d)this.unreflectChild(a[d])};b.prototype.clearReflectedObjectProperty=function(a,
d,c){void 0===c&&(c=!1);var b=a[d];a.hasOwnProperty(d)&&Reflect.deleteProperty(a,d);c&&(a[d]=b)};b.prototype.unreflectChild=function(a){for(var d=this.properties,c=0;c<d.length;++c)this.clearReflectedObjectProperty(a,d[c],!0);a=this.getChildIndexByChild(a);-1<a&&this.children.splice(a,1)};b.prototype.createReflection=function(a){this.isChildRegistered(a)||(this.registerChild(a),this.synchronizeChildState(a),this.enableChildReflection&&this.createChildReflection(a))};b.prototype.createChildReflection=
function(a){for(var d=this.object,c=this.properties,b=function(b){var e=c[b];Object.defineProperty(a,e,{enumerable:!1,configurable:!0,get:function(){return d[e]},set:function(a){return d["__$"+e]=a}})},e=0;e<c.length;++e)b(e)};b.prototype.createObjectPropertyLinks=function(a){for(var d=this,c=this.properties,b=function(b){var e=c[b];Object.defineProperty(a,"__$"+e,{writable:!0,enumerable:!1,configurable:!0,value:a[e]});Object.defineProperty(a,e,{get:function(){return a["__$"+e]},set:function(a){return d.updateLinkedChildrenPropertyValues(e,
a)}})},e=0;e<c.length;++e)b(e)};b.prototype.registerChild=function(a){this.children.push(a)};b.prototype.isChildRegistered=function(a){return-1<this.getChildIndexByChild(a)};b.prototype.getChildIndexByChild=function(a){for(var b=this.children,c=0;c<b.length;++c)if(b[c]===a)return c;return-1};b.prototype.synchronizeChildState=function(a){for(var b=this.object,c=this.properties,f=0;f<c.length;++f){var e=c[f];a[e]=b[e]}};b.prototype.updateLinkedChildrenPropertyValues=function(a,b){this.object["__$"+
a]=b;for(var c=this.children,d=0;d<c.length;++d)c[d][a]=b;return b};return b});